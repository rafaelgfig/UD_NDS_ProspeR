Explorando e resumindo dados de empréstimos da Prosper por Rafael G. Figueira
========================================================
<p>Esse relatório explora um conjunto de dados de empréstimos da Prosper, possuindo 113.937 empréstimos com 81 variáveis em cada um, incluindo valor, taxa de juros, status do pagamento, receita do mutuário, seu emprego atual, histórico do cartão de crédito, informações sobre seu último pagamento, entre outras.</p>
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Carregamento das bibliotécas
library(dplyr)
library(gridExtra)
library(ggplot2)
library(tidyr)
library(purrr)
```

```{r echo=FALSE, Load_the_Data}
# Carregamento dos dados
df <- read.csv('prosperLoanData.csv')
```

## Seção de Gráficos Univariados
<p>O conjunto de dados original possui 113937 linhas e 81 colunas.</p>
```{r echo=FALSE, Univariate_Plots}
# Dimensão dos dados originais
dim(df)
```
<p>Foram escolhidas 14 variáveis julgadas mais interessantes para a minha análise.<br/> Sendo elas:</p>
* LoanKey
* Term
* LoanStatus
* BorrowerAPR
* BorrowerRate
* ProsperScore
* ListingCategory..numeric.
* Occupation
* EmploymentStatus
* EmploymentStatusDuration
* StatedMonthlyIncome
* LoanOriginalAmount
* LoanOriginationDate
* MonthlyLoanPayment

Abaixo seguem algumas informações úteis sobre os dados.<br/>
```{r echo=FALSE}
# Selecionando algumas colunas de interesse
dff <- (subset(df, select = c('LoanKey',
                              'Term',
                              'LoanStatus',
                              'BorrowerAPR',
                              'BorrowerRate',
                              'ProsperScore',
                              'ListingCategory..numeric.',
                              'Occupation',
                              'EmploymentStatus',
                              'EmploymentStatusDuration',
                              'StatedMonthlyIncome',
                              'LoanOriginalAmount',
                              'LoanOriginationDate',
                              'MonthlyLoanPayment')
            )
     )
```


```{r echo=FALSE}
# Colunas e tipos de dados
str(dff)
```

```{r echo=FALSE}
# Resumo estatístico
summary(dff)
```
Visualizando distribuição das variáveis selecionadas.<br/>
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height=12}
# Histograma básico das colunas
dff %>%
  keep(is.numeric) %>%
  gather() %>%
  ggplot(aes(value)) +
    facet_wrap(~key, scales = 'free', ncol = 1) +
    geom_histogram()
```

<p>É possível ver que o histograma da variável <em>StatedMonthlyIncome</em> está totalmente concentrado em zero.</p>
Analizando o resumo estatístico é possível ver que a variável contém alguns dados discrepantes.
```{r echo=FALSE}
# Verificando que plotagem da renda mensal está enviesada por conta de outlier
summary(dff$StatedMonthlyIncome)
```

<p>Os 10 valores mais altos da variável são:</p>
```{r echo=FALSE}
# Visualizando as 10 maiores rendas declaradas
sort(tail(sort(dff$StatedMonthlyIncome), 10), decreasing = T)
```

<p>Visualizando os dados sem 0.5% dos maiores valores.</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Plotagem removendo 0.5% das maiores rendas
ggplot(dff, aes(x = StatedMonthlyIncome)) +
  geom_histogram(binwidth = 250) +
  scale_x_continuous(limits = c(0, quantile(dff$StatedMonthlyIncome, .995)))
```

<p>Omitindo 5% dos maiores valores:</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Plotagem removendo 5% das maiores rendas
ggplot(dff, aes(x = StatedMonthlyIncome)) +
  geom_histogram(binwidth = 250, color = 'black') +
  scale_x_continuous(limits = c(0, quantile(dff$StatedMonthlyIncome, .95)),
                     breaks = seq(0, 12500, 1000))
```

Nos gráficos abaixo podemos ver que a maioria dos empréstimo possuem valores arredondados, dando ênfase para empréstimos de 4.000, os posteriores tendem a ser múltiplos de 5.000.<br/>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Distribuição dos dados da coluna LoanOriginalAmount
g <- ggplot(df, aes(x = LoanOriginalAmount)) +
  scale_x_continuous(breaks = seq(0, max(df$LoanOriginalAmount), 5000))
g1 <- g + geom_histogram(binwidth = 1000)
g2 <- g + geom_histogram(binwidth = 500)
g3 <- g + geom_histogram(binwidth = 250)
grid.arrange(g1, g2, g3, ncol = 1)
```

<p>Abaixo é possível observar que é mais comum encontrar pessoas com poucos meses de emprego solicitando empréstimo do que em comparação com aqueles com muito tempo.</p>
Tempo em meses:<br/>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Distribuição do tempo de emprego omitindo 5%
ggplot(subset(dff, !is.na(EmploymentStatusDuration)), aes(x = EmploymentStatusDuration)) +
  geom_histogram(binwidth = 1) +
  scale_x_continuous(limits = c(0, quantile(dff$EmploymentStatusDuration, .95, na.rm = T)),
                     breaks = seq(0, 300, 25))
```

Tempo em anos:<br/>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Distribuição do tempo de emprego em anos omitindo 5%
ggplot(subset(dff, !is.na(EmploymentStatusDuration)), aes(x = floor(EmploymentStatusDuration/12))) +
  geom_histogram(binwidth = 1, color = 'black') +
  scale_x_continuous(limits = c(0, quantile(dff$EmploymentStatusDuration/12, .95, na.rm = T)),
                     breaks = seq(0, 25, 1))
```

Distribuição dos status do emprego:<br/>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Distribuição dos status do emprego
ggplot(subset(dff, EmploymentStatus != ''), aes(x = reorder(EmploymentStatus, -table(EmploymentStatus)[EmploymentStatus]))) +
  geom_bar() +
  xlab('EmploymentStatus')
```
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Porcentagem de mutuários declaradamente sem emprego
round(sum(dff$EmploymentStatus == 'Not employed')/length(dff$EmploymentStatus),digits = 3)*100
```

<br/>A grande maioria dos solicitantes de empréstimos está atualmente empregado de alguma forma. Apenas 0.7% dos mutuários são declaradamente desempregados.

Categorias mais selecionadas pelo mutuário:<br/>
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height=3, fi}
# Alterando variável ListingCategory..numeric. para categórica
dff$ListingCategory..numeric. <- factor(dff$ListingCategory..numeric.)
# Distribuição dos status do emprego
ggplot(dff, aes(x = reorder(ListingCategory..numeric., -table(ListingCategory..numeric.)[ListingCategory..numeric.]))) +
  geom_bar(width = .8) +
  scale_y_continuous(breaks = scales::trans_breaks('log10', function(x) 10^x),
                     labels = scales::trans_format('log10', scales::math_format(10^.x)),
                     trans = 'log10')+
  xlab('ListingCategory')
```
<br/> Legenda das categorias:

0. Não disponível
1. Consolidação da dívida
2. Melhoria da casa
3. Negócios
4. Empréstimo pessoal
5. Uso do aluno
6. Automático
7- Outros 8. Bebê e Adoção
9. Barco
10. Procedimento Cosmético
11. Anel de Noivado
12. Empréstimos Verdes
13. Gastos Domésticos
14. Grandes Compras
15. Médico / Odontológico
16. Motocicleta
17. VD
18. Impostos
19. Férias
20. Empréstimos do casamento


# Análise Univariada

### Qual é a estrutura do conjunto de dados?

### Quais são os principais atributos de interesse deste conjunto de dados?

### Quais outros atributos você acha que podem lhe auxiliar na investigação destes atributos de interesse?

### Você criou novas variáveis a partir dos atributos existentes no conjunto de dados?

### Dos atributos investigados, distribuições incomuns foram encontradas? Você aplicou operações nos dados para limpá-los, ajustá-los ou mudar a forma dos dados? Se sim, por quê?



# Seção de Gráficos Bivariados
```{r echo=FALSE, Bivariate_Plots}

```

# Análise Bivariada

### Discuta sobre alguns dos relacionamentos observados nesta parte da investigação. Como os atributos de interesse variaram no conjunto de dados?

### Você observou algum relacionamento interessante entre os outros atributos (os que não são de interesse)?

### Qual foi o relacionamento mais forte encontrado?




# Seção de Gráficos Multivariados

```{r echo=FALSE, Multivariate_Plots}

```

# Análise Multivariada

### Discuta sobre os relacionamentos observados nesta parte da investigação. Quais atributos que fortaleceram os demais na observação das variáveis de interesse?

### Interações surpreendentes e/ou interessantes foram encontradas entre os atributos?

### OPCIONAL: Modelos foram criados usando este conjunto de dados? Discuta sobre os pontos fortes e as limitações do seu modelo.

------

# Gráficos Finais e Sumário

### Primeiro Gráfico
```{r echo=FALSE, Plot_One}

```

### Descrição do Primeiro Gráfico


### Segundo Gráfico
```{r echo=FALSE, Plot_Two}

```

### Descrição do Segundo Gráfico


### Terceiro Gráfico
```{r echo=FALSE, Plot_Three}

```

### Descrição do Terceiro Gráfico

------

# Reflexão


